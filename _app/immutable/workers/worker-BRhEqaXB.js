var j=Object.defineProperty;var F=(f,l,w)=>l in f?j(f,l,{enumerable:!0,configurable:!0,writable:!0,value:w}):f[l]=w;var h=(f,l,w)=>F(f,typeof l!="symbol"?l+"":l,w);(function(){"use strict";class f{constructor(t=4096){h(this,"next");h(this,"data");h(this,"length",0);h(this,"head",0);this.cap=t,this.data=new Array(t)}get can_push(){return this.length<this.cap}get can_pop(){return this.head<this.length}push(t){this.data[this.length++]=t}pop(){return this.data[this.head++]}reset(){this.length=0,this.head=0,this.next=void 0}}class l{constructor(){h(this,"pull",[]);h(this,"head",new f);h(this,"tail",this.head)}push(t){if(!this.tail.can_push){const e=this.newChunk();this.tail.next=e,this.tail=e}this.tail.push(t)}pop(){if(this.head.can_pop)return this.head.pop();if(this.head.can_push||!this.head.next)throw new Error("Unexpected pop from empty queue");return this.pull.push(this.head),this.head=this.head.next,this.head.pop()}isEmpty(){return this.head===this.tail&&!this.head.can_pop}newChunk(){if(this.pull.length){const t=this.pull.pop();return t.reset(),t}return new f}}class w{constructor(t,e){this.hash=t,this.newSet=e}solve(t,e,r){const n=new l;n.push({value:t,depth:0});const i=this.newSet();for(i.add(this.hash(t));!n.isEmpty();){const a=n.pop();for(let o=0;o<r.length;++o){const c=r[o];if(!c.correct(a.value))continue;const u=c.apply(a.value);if(i.add(this.hash(u))){if(u===e){const d=new Array(a.depth+1);d[a.depth]=c;for(let p=a;p.op;p=p.from)d[p.depth-1]=p.op;return{ok:!0,operations:d,visitedStates:i.size()}}n.push({from:a,op:c,value:u,depth:a.depth+1})}}}return{ok:!1,operations:[],visitedStates:i.size()}}}class b{constructor(){h(this,"data",new Int32Array(65536));h(this,"index",0)}push(t,e,r,n){if(this.index+=1,this.data.length<=this.index*4){const a=new Int32Array(this.data.length*2);for(let o=0;o<this.data.length;++o)a[o]=this.data[o];this.data=a}const i=(this.index-1)*4;this.data[i+0]=t,this.data[i+1]=e,this.data[i+2]=r,this.data[i+3]=n}from(t){return this.data[t*4+0]}op(t){return this.data[t*4+1]}value(t){return this.data[t*4+2]}depth(t){return this.data[t*4+3]}length(){return this.index}}class A{constructor(t,e){this.hash=t,this.newSet=e}solve(t,e,r){const n=new b;n.push(-1,-1,t,0);const i=this.newSet();i.add(this.hash(t));for(let a=0;a<n.length();++a){const o=n.value(a),c=n.depth(a);for(let u=0;u<r.length;++u){const d=r[u];if(!d.correct(o))continue;const p=d.apply(o),O=this.hash(p);if(i.add(O)){if(p===e){const k=new Array(c+1);k[c]=d;for(let g=a;n.op(g)>=0;g=n.from(g))k[n.depth(g)-1]=r[n.op(g)];return{ok:!0,operations:k,visitedStates:i.size()}}n.push(a,u,p,c+1)}}}return{ok:!1,operations:[],visitedStates:i.size()}}}class S{constructor(t,e=new m(t,this)){this.n=t,this.inverse=e}apply(t){return t+this.n}correct(){return!0}toString(){return`+${this.n}`}}class m{constructor(t,e=new S(t,this)){this.n=t,this.inverse=e}apply(t){return t-this.n}correct(){return!0}toString(){return`-${this.n}`}}class y{constructor(t,e=new I(t,this)){this.n=t,this.inverse=e}apply(t){return t*this.n}correct(){return!0}toString(){return`*${this.n}`}}class I{constructor(t,e=new y(t,this)){this.n=t,this.inverse=e}apply(t){return t/this.n}correct(t){return t%this.n===0}toString(){return`/${this.n}`}}class z{constructor(){h(this,"root");h(this,"count",0)}add(t){if(!this.root)return this.root={value:t,left:void 0,right:void 0},this.count++,!0;let e=this.root,r=this.root,n=!1;for(;e;)if(r=e,n=t<e.value,n)e=e.left;else if(e.value<t)e=e.right;else return!1;this.count++;const i={value:t,left:void 0,right:void 0};return n?r.left=i:r.right=i,!0}has(t){let e=this.root;for(;e;)if(t<e.value)e=e.left;else if(e.value<t)e=e.right;else return!0;return!1}size(){return this.count}}class E{constructor(){h(this,"data",Object.create(null));h(this,"count",0)}add(t){return this.data[t]?!1:(this.count++,this.data[t]=!0)}has(t){return this.data[t]}size(){return this.count}}class M{constructor(){h(this,"data",new Int32Array(65537));h(this,"max_iteration",15);h(this,"count",0);h(this,"hasZero",!1)}hash(t){return t=(t>>16^t)*73244475|0,t=(t>>16^t)*73244475|0,t=t>>16^t|0,t%this.data.length}add(t){if(t===0)return this.hasZero?!1:this.hasZero=!0;let e=this.hash(t);for(let r=0;r<this.max_iteration;++r){if(this.data[e]==t)return!1;if(this.data[e]==0)return this.data[e]=t,this.count++,!0;e=(e+1)%this.data.length}return this.rehash(),this.add(t)}has(t){if(t===0)return this.hasZero;let e=this.hash(t);for(let r=0;r<this.max_iteration;++r){if(this.data[e]==t)return!0;e=(e+1)%this.data.length}return!1}size(){return this.count}rehash(){const t=this.data;this.data=new Int32Array((this.data.length-1)*2+1);for(let e=0;e<t.length;++e)t[e]!=0&&this.add(t[e])}}function T(s){switch(s){case 0:return new E;case 1:return new z;case 2:return new M;default:throw new Error(`Unknown SetType ${s}`)}}function $(s,t,e){const r=()=>T(t);switch(s){case 0:return new w(e,r);case 1:return new A(e,r);default:throw new Error(`Unknown solver type ${s}`)}}const x=new y(2),v=new S(3),N=new m(2),C=[x,v],U=[x,v,N];onmessage=function(s){const t=s.data.task;Z(s.data);try{switch(t.type){case"numbers":{const e=$(t.algorithm,t.set,d=>d);let{start:r,finish:n}=t,i=t.operations=="two"?C:U;const a=performance.now();t.order==="backward"&&(i=i.map(d=>d.inverse),r=n,n=t.start);const o=e.solve(r,n,i),c=performance.now(),u=o.operations.map(d=>t.order=="forward"?d.toString():d.inverse.toString());t.order=="backward"&&u.reverse(),B(s.data,{timeMs:c-a,nodesVisited:o.visitedStates,operations:u});break}default:_(s.data,"Unknown type of task");break}}catch(e){_(s.data,e instanceof Error?e.message:typeof e=="string"?e:JSON.stringify(e))}};function Z(s){const t={taskId:s.taskId,status:"started",task:s.task,time:performance.now()};postMessage(t)}function B(s,t){const e={taskId:s.taskId,status:"resolved",task:s.task,result:t};postMessage(e)}function _(s,t){const e={taskId:s.taskId,status:"error",task:s.task,error:t};postMessage(e)}})();
